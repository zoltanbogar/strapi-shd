"use strict";(self.webpackChunksmarthomedoctor_strapi=self.webpackChunksmarthomedoctor_strapi||[]).push([[5895],{10608:(ee,b,t)=>{t.r(b),t.d(b,{SettingsPage:()=>Ft,default:()=>Wn});var e=t(67294),h=t(68547),i=t(49656),te=t(17034),Y=t(97132),Xe=t(15482),se=t(48474),Oe=t(38683),Ze=t(23724),Fe=t(67838),nt=t(49066),H=t(185),L=t(41580),T=t(11276),Re=t(74571),U=t(75515),Me=t(7681),$=t(29728),je=t(36182),_=t(17772),F=t(85018),qe=t(87751),G=t(45697),f=t.n(G);const ze=750,ie=100,Ge=["image/jpeg","image/png","image/svg+xml"];var we=t(73987),ct=t(17973),_e=t(59689),Qe=t(12028),st=t(96315),it=t(30815),ot=t(42866),le=t(24969),Ye=t(60612);const pe={localImage:void 0},w=(g=pe,d)=>(0,Ye.default)(g,p=>{switch(d.type){case"SET_LOCAL_IMAGE":{p.localImage=d.value;break}default:return p}}),oe=({onChangeLogo:g,customLogo:d,goTo:p,Component:C,modalTitle:u,next:I,prev:z,currentStep:W})=>{const[{localImage:Ee},J]=(0,e.useReducer)(w,pe),{formatMessage:ye}=(0,Y.useIntl)(),V=Le=>{J({type:"SET_LOCAL_IMAGE",value:Le})},We=()=>{p(null)};return W?e.createElement(ot.P,{labelledBy:"modal",onClose:We},e.createElement(le.x,null,e.createElement(U.Z,{fontWeight:"bold",as:"h2",id:"modal"},ye(u))),e.createElement(C,{setLocalImage:V,goTo:p,next:I,prev:z,onClose:We,asset:Ee||d,onChangeLogo:g})):null};oe.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},oe.propTypes={Component:f().elementType,currentStep:f().string,customLogo:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}),goTo:f().func.isRequired,modalTitle:f().shape({id:f().string,defaultMessage:f().string}),next:f().string,onChangeLogo:f().func.isRequired,prev:f().string};const K=oe,X={currentStep:void 0},he=(g=X,d)=>(0,Ye.default)(g,p=>{switch(d.type){case"GO_TO":{p.currentStep=d.to;break}default:return p}});var De=t(82777),Be=t(60633),re=t(42761),Ue=t(70004),Ke=t(71893),E=t(11047),Ve=t(52624),R=t(36856),Z=t(45377),j=t(54574),ce=t(96404),ae=t(35957);const Q={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},Ce={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},$e=g=>new Promise(d=>{const p=new FileReader;p.onload=()=>{const C=new Image;C.onload=function(){d({width:C.width,height:C.height})},C.src=p.result},p.readAsDataURL(g)}),dt=(g,d)=>({ext:g.name.split(".").pop(),size:g.size/1e3,name:g.name,url:URL.createObjectURL(g),rawFile:g,width:d.width,height:d.height}),M=async g=>{let d;if(!Ge.includes(g.type))throw d=new Error("File format"),d.displayMessage=Q,d;const C=await $e(g);if(!(C.width<=ze&&C.height<=ze))throw d=new Error("File sizing"),d.displayMessage=Ce,d;const I=dt(g,C);if(!(I.size<=ie))throw d=new Error("File sizing"),d.displayMessage=Ce,d;return I},be=(0,Ke.default)(Z._)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,ut=({setLocalImage:g,goTo:d,next:p,onClose:C})=>{const{formatMessage:u}=(0,Y.useIntl)(),[I,z]=(0,e.useState)(!1),[W,Ee]=(0,e.useState)(void 0),J=(0,e.useRef)(null),ye=()=>z(!0),V=()=>z(!1),We=at=>{at.preventDefault(),J.current.click()},Le=async()=>{V();const at=J.current.files[0];if(at)try{const lt=await M(at);g(lt),d(p)}catch(lt){if(lt.displayMessage)Ee(u(lt.displayMessage,{size:ie,dimension:ze})),J.current.focus();else throw lt}},Je=()=>I?"primary500":W?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(L.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(j.g,{name:"logo-upload",error:W},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(Me.K,{spacing:2},e.createElement(E.k,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:I?"primary100":"neutral100",borderColor:Je(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:ye,onDragLeave:V},e.createElement(Ve.J,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:ae.Z,"aria-hidden":!0}),e.createElement(L.x,{paddingTop:3,paddingBottom:5},e.createElement(U.Z,{variant:"delta",as:"span"},u({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(be,{accept:Ge,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:Le,ref:J,id:"logo-upload"}),e.createElement($.z,{type:"button",onClick:We},u({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(L.x,{paddingTop:6},e.createElement(U.Z,{variant:"pi",textColor:"neutral600"},u({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:ie,dimension:ze})))),e.createElement(ce.c,null)))))),e.createElement(R.m,{startActions:e.createElement($.z,{onClick:C,variant:"tertiary"},u({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};ut.defaultProps={next:null},ut.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const Rt=ut;var Nt=t(16364),Zt=t(11817);const In=async g=>{try{const d=await Zt.Z.get(g,{responseType:"blob",timeout:8e3});return new File([d.data],d.config.url,{type:d.headers["content-type"]})}catch(d){throw d.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},d}},ht=({goTo:g,next:d,onClose:p,setLocalImage:C})=>{const{formatMessage:u}=(0,Y.useIntl)(),[I,z]=(0,e.useState)(""),[W,Ee]=(0,e.useState)(null),J=V=>{z(V.target.value)},ye=async()=>{try{const V=await In(I),We=await M(V);C(We),g(d)}catch(V){if(V.displayMessage)Ee(u(V.displayMessage,{size:ie,dimension:ze}));else throw V}};return e.createElement("form",{onSubmit:V=>{V.preventDefault(),ye()}},e.createElement(L.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(Nt.o,{label:u({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:W,onChange:J,value:I,name:"logo-url"})),e.createElement(R.m,{startActions:e.createElement($.z,{onClick:p,variant:"tertiary"},u({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement($.z,{type:"submit"},u({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};ht.defaultProps={next:null},ht.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const On=ht,et=({setLocalImage:g,goTo:d,next:p,onClose:C})=>{const{formatMessage:u}=(0,Y.useIntl)();return e.createElement(De.v,{label:u({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(L.x,{paddingLeft:8,paddingRight:8},e.createElement(Be.m,null,e.createElement(Be.O,null,u({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(Be.O,null,u({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement(Ue.i,null)),e.createElement(re.n,null,e.createElement(re.x,null,e.createElement(Rt,{onClose:C,setLocalImage:g,goTo:d,next:p})),e.createElement(re.x,null,e.createElement(On,{onClose:C,setLocalImage:g,goTo:d,next:p}))))};et.defaultProps={next:null},et.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const Fn=et;var qt=t(99220),_t=t(19093),Bn=t(87535),Ct=t(25001),Nn=t(75517),mt=t(20799),jt=t(41384);const Mt=({asset:g})=>{const{formatMessage:d}=(0,Y.useIntl)();return e.createElement(qt.Z,null,e.createElement(_t.O,null,e.createElement(Bn.H,{size:"S",src:g.url})),e.createElement(Ct.e,null,e.createElement(Nn.a,null,e.createElement(mt.l,null,g.name),e.createElement(mt._,null,`${g.ext.toUpperCase()} - ${g.width}\u2715${g.height}`)),e.createElement(jt.E,null,d({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};Mt.propTypes={asset:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}).isRequired};const zt=Mt,Dt=({onClose:g,asset:d,prev:p,next:C,goTo:u,setLocalImage:I,onChangeLogo:z})=>{const{formatMessage:W}=(0,Y.useIntl)(),Ee=()=>{I(void 0),u(p)},J=()=>{z(d),u(C)};return e.createElement(e.Fragment,null,e.createElement(L.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(E.k,{justifyContent:"space-between",paddingBottom:6},e.createElement(E.k,{direction:"column",alignItems:"flex-start"},e.createElement(U.Z,{variant:"pi",fontWeight:"bold"},W({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement(U.Z,{variant:"pi",textColor:"neutral500"},W({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement($.z,{onClick:Ee,variant:"secondary"},W({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(L.x,{maxWidth:(0,h.pxToRem)(180)},e.createElement(zt,{asset:d}))),e.createElement(R.m,{startActions:e.createElement($.z,{onClick:g,variant:"tertiary"},W({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement($.z,{onClick:J},W({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};Dt.defaultProps={next:null,prev:null},Dt.propTypes={goTo:f().func.isRequired,asset:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}).isRequired,next:f().string,onClose:f().func.isRequired,onChangeLogo:f().func.isRequired,prev:f().string,setLocalImage:f().func.isRequired};const Ut={upload:{Component:Fn,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:Dt,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},Lt=({canUpdate:g,customLogo:d,defaultLogo:p,hint:C,label:u,onChangeLogo:I,onResetLogo:z})=>{const[{currentStep:W},Ee]=(0,e.useReducer)(he,X),{Component:J,next:ye,prev:V,modalTitle:We}=Ut[W]||{},{formatMessage:Le}=(0,Y.useIntl)(),Je=at=>{Ee({type:"GO_TO",to:at})};return e.createElement(e.Fragment,null,e.createElement(we.F,{label:u,selectedSlide:0,hint:C,previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:d?.name||"logo.png",actions:e.createElement(ct.b,null,e.createElement(Qe.h,{disabled:!g,onClick:()=>Je(d?"pending":"upload"),label:Le({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(st.default,null)}),d&&e.createElement(Qe.h,{disabled:!g,onClick:z,label:Le({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(it.Z,null)}))},e.createElement(_e.q,{label:Le({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(L.x,{maxHeight:"40%",maxWidth:"40%",as:"img",src:d?.url||p,alt:Le({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(K,{Component:J,currentStep:W,onChangeLogo:I,customLogo:d,goTo:Je,next:ye,prev:V,modalTitle:We}))};Lt.defaultProps={canUpdate:!1,customLogo:null,hint:null},Lt.propTypes={canUpdate:f().bool,customLogo:f().shape({url:f().string,name:f().string}),label:f().string.isRequired,hint:f().string,defaultLogo:f().string.isRequired,onChangeLogo:f().func.isRequired,onResetLogo:f().func.isRequired};const xt=Lt,Pt={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}},authLogo:{display:null,submit:{rawFile:null,isReset:!1}}},nn=(g=Pt,d)=>(0,Ye.default)(g,p=>{switch(d.type){case"SET_CUSTOM_MENU_LOGO":{p.menuLogo.display=d.value,p.menuLogo.submit.rawFile=d.value.rawFile;break}case"SET_CUSTOM_AUTH_LOGO":{p.authLogo.display=d.value,p.authLogo.submit.rawFile=d.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{p.menuLogo.display=null,p.menuLogo.submit={rawFile:null,isReset:!0};break}case"RESET_CUSTOM_AUTH_LOGO":{p.authLogo.display=null,p.authLogo.submit={rawFile:null,isReset:!0};break}default:return p}});var $t=t(82492),on=t.n($t);const sn=(g,d)=>on()(g,{menuLogo:{display:d.menuLogo},authLogo:{display:d.authLogo}}),pt=(0,e.forwardRef)(({canUpdate:g,projectSettingsStored:d},p)=>{const{formatMessage:C}=(0,Y.useIntl)(),{trackUsage:u}=(0,h.useTracking)(),{logos:{menu:I,auth:z}}=(0,se.um)(),[{menuLogo:W,authLogo:Ee},J]=(0,e.useReducer)(nn,Pt,()=>sn(Pt,d)),ye=Je=>{J({type:"SET_CUSTOM_MENU_LOGO",value:Je})},V=()=>{u("didClickResetLogo",{logo:"menu"}),J({type:"RESET_CUSTOM_MENU_LOGO"})},We=Je=>{J({type:"SET_CUSTOM_AUTH_LOGO",value:Je})},Le=()=>{u("didClickResetLogo",{logo:"auth"}),J({type:"RESET_CUSTOM_AUTH_LOGO"})};return(0,e.useImperativeHandle)(p,()=>({getValues:()=>({menuLogo:W.submit,authLogo:Ee.submit})})),e.createElement(L.x,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(U.Z,{variant:"delta",as:"h3"},C({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement(U.Z,{variant:"pi",textColor:"neutral600"},C({id:"Settings.application.customization.size-details",defaultMessage:"Max dimension: {dimension}\xD7{dimension}, Max file size: {size}KB"},{dimension:ze,size:ie})),e.createElement(T.r,{paddingTop:4,gap:4},e.createElement(Re.P,{col:6,s:12},e.createElement(xt,{canUpdate:g,customLogo:W.display,defaultLogo:I.default,hint:C({id:"Settings.application.customization.menu-logo.carousel-hint",defaultMessage:"Replace the logo in the main navigation"}),label:C({id:"Settings.application.customization.carousel.menu-logo.title",defaultMessage:"Menu logo"}),onChangeLogo:ye,onResetLogo:V})),e.createElement(Re.P,{col:6,s:12},e.createElement(xt,{canUpdate:g,customLogo:Ee.display,defaultLogo:z.default,hint:C({id:"Settings.application.customization.auth-logo.carousel-hint",defaultMessage:"Replace the logo in the authentication pages"}),label:C({id:"Settings.application.customization.carousel.auth-logo.title",defaultMessage:"Auth logo"}),onChangeLogo:We,onResetLogo:Le}))))});pt.defaultProps={canUpdate:!1,projectSettingsStored:null},pt.propTypes={canUpdate:f().bool,projectSettingsStored:f().shape({menuLogo:f().shape({url:f().string,name:f().string})})};const ln=pt;var rn=t(23998),Wt=t(68718),Zn=t.n(Wt);const kt=g=>Zn()(g,(d,p,C)=>{p&&p.url?d[C]={...p,url:(0,h.prefixFileUrlWithBackendUrl)(p.url)}:d[C]=p},{}),cn=async()=>{const{data:g}=await rn.be.get("/admin/project-settings");return kt(g)},dn=async g=>{const{data:d}=await rn.be.post("/admin/project-settings",g,{headers:{"Content-Type":"multipart/form-data"}});return kt(d)},un=g=>{const d=new FormData;return Object.entries(g).forEach(([p,C])=>{C&&C.rawFile instanceof File&&d.append(p,C.rawFile),C&&C.isReset&&d.append(p,null)}),d},wt=()=>{const g=(0,e.useRef)(),d=(0,h.useNotification)(),{trackUsage:p}=(0,h.useTracking)(),{formatMessage:C}=(0,Y.useIntl)(),u=(0,Ze.useQueryClient)();(0,h.useFocusWhenNavigate)();const I=(0,h.useAppInfos)(),{shouldUpdateStrapi:z,latestStrapiReleaseTag:W,strapiVersion:Ee}=I,{updateProjectSettings:J}=(0,se.um)(),{allowedActions:{canRead:ye,canUpdate:V}}=(0,h.useRBAC)(qe.Z.settings["project-settings"]),We=ye&&V,{data:Le}=(0,Ze.useQuery)("project-settings",cn,{enabled:ye}),Je=I.communityEdition?"app.components.UpgradePlanModal.text-ce":"app.components.UpgradePlanModal.text-ee",at=(0,Ze.useMutation)(Et=>dn(Et),{async onSuccess({menuLogo:Et,authLogo:bt}){await u.invalidateQueries("project-settings",{refetchActive:!0}),J({menuLogo:Et?.url,authLogo:bt?.url})}}),lt=Et=>{if(Et.preventDefault(),!V)return;const bt=g.current.getValues(),Tn=un(bt);at.mutate(Tn,{onSuccess(){const{menuLogo:Yt,authLogo:kn}=bt;Yt.rawFile&&p("didChangeLogo",{logo:"menu"}),kn.rawFile&&p("didChangeLogo",{logo:"auth"}),d({type:"success",message:C({id:"app",defaultMessage:"Saved"})})},onError(){d({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}})};return e.createElement(te.A,null,e.createElement(h.SettingsPageTitle,{name:"Application"}),e.createElement(H.o,null,e.createElement("form",{onSubmit:lt},e.createElement(Fe.T,{title:C({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:C({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:We&&e.createElement($.z,{type:"submit",startIcon:e.createElement(F.Z,null)},C({id:"global.save",defaultMessage:"Save"}))}),e.createElement(nt.D,null,e.createElement(Me.K,{spacing:6},e.createElement(Me.K,{spacing:5,hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(U.Z,{variant:"delta",as:"h3"},C({id:"global.details",defaultMessage:"Details"})),e.createElement(T.r,{paddingTop:1},e.createElement(Re.P,{col:6,s:12},e.createElement(U.Z,{variant:"sigma",textColor:"neutral600"},C({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})),e.createElement(U.Z,{as:"p"},"v",Ee),e.createElement(je.r,{href:I.communityEdition?"https://discord.strapi.io":"https://support.strapi.io/support/home",isExternal:!0,endIcon:e.createElement(_.Z,null)},C({id:"Settings.application.get-help",defaultMessage:"Get help"}))),e.createElement(Re.P,{col:6,s:12},e.createElement(U.Z,{variant:"sigma",textColor:"neutral600"},C({id:"Settings.application.edition-title",defaultMessage:"current plan"})),e.createElement(U.Z,{as:"p"},C({id:Je,defaultMessage:`${I.communityEdition?"Community Edition":"Enterprise Edition"}`})))),e.createElement(T.r,{paddingTop:1},e.createElement(Re.P,{col:6,s:12},z&&e.createElement(je.r,{href:`https://github.com/strapi/strapi/releases/tag/${W}`,isExternal:!0,endIcon:e.createElement(_.Z,null)},C({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"}))),e.createElement(Re.P,{col:6,s:12},e.createElement(je.r,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(_.Z,null)},C({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})))),e.createElement(L.x,{paddingTop:1},e.createElement(U.Z,{variant:"sigma",textColor:"neutral600"},C({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement(U.Z,{as:"p"},I.nodeVersion))),ye&&Le&&e.createElement(ln,{canUpdate:V,ref:g,projectSettingsStored:Le}))))))};var pn=t(94654),gn=t.n(pn);const fn=g=>gn()(g,p=>p.links).map(p=>(0,Oe.ot)(p.Component,p.to,p.exact||!1)),Kt=g=>g.filter(d=>!d.links.every(p=>p.isDisplayed===!1));var Vt=t(42982),tt=t(15861),$n=t(64687),de=t.n($n),It=function(){return window&&window.strapi&&window.strapi.isEE?t(26789).Z:t(73871).Z}(),Ht=function(){return window&&window.strapi&&window.strapi.isEE?t(64527).Z:t(85302).Z}(),hn=[{Component:function(){return{default:Ht}},to:"/settings/roles",exact:!0},{Component:function(){return{default:It}},to:"/settings/roles/duplicate/:id",exact:!0},{Component:function(){return{default:It}},to:"/settings/roles/new",exact:!0},{Component:function(){return(0,tt.Z)(de().mark(function d(){var p;return de().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(2544).then(t.bind(t,92100));case 2:return p=u.sent,u.abrupt("return",p);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/roles/:id",exact:!0},{Component:function(){return(0,tt.Z)(de().mark(function d(){var p;return de().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5199).then(t.bind(t,46903));case 2:return p=u.sent,u.abrupt("return",p);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/users",exact:!0},{Component:function(){return(0,tt.Z)(de().mark(function d(){var p;return de().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(4263).then(t.bind(t,22282));case 2:return p=u.sent,u.abrupt("return",p);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/users/:id",exact:!0},{Component:function(){return(0,tt.Z)(de().mark(function d(){var p;return de().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5162).then(t.bind(t,3672));case 2:return p=u.sent,u.abrupt("return",p);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/webhooks/create",exact:!0},{Component:function(){return(0,tt.Z)(de().mark(function d(){var p;return de().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5162).then(t.bind(t,9311));case 2:return p=u.sent,u.abrupt("return",p);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/webhooks/:id",exact:!0},{Component:function(){return(0,tt.Z)(de().mark(function d(){var p;return de().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(4121).then(t.bind(t,11199));case 2:return p=u.sent,u.abrupt("return",p);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/webhooks",exact:!0},{Component:function(){return(0,tt.Z)(de().mark(function d(){var p;return de().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(8056).then(t.bind(t,8421));case 2:return p=u.sent,u.abrupt("return",p);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/api-tokens",exact:!0},{Component:function(){return(0,tt.Z)(de().mark(function d(){var p;return de().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(4225),t.e(7375),t.e(4299)]).then(t.bind(t,9683));case 2:return p=u.sent,u.abrupt("return",p);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/api-tokens/create",exact:!0},{Component:function(){return(0,tt.Z)(de().mark(function d(){var p;return de().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(4225),t.e(7375),t.e(92)]).then(t.bind(t,28465));case 2:return p=u.sent,u.abrupt("return",p);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/api-tokens/:id",exact:!0}];const Ot=hn;var Cn=function(){return window&&window.strapi&&window.strapi.isEE?t(5420).Z:t(35301).Z}();const En=[].concat((0,Vt.Z)(Cn),(0,Vt.Z)(Ot));var Xt=t(53192),yn=t(38702),vn=t(34446),Qt=t(29489),Sn=t(52305);const St=({menu:g})=>{const{formatMessage:d}=(0,Y.useIntl)(),C=Kt(g).map(I=>({...I,title:I.intlLabel,links:I.links.map(z=>({...z,title:z.intlLabel,name:z.id}))})),u=d({id:"global.settings",defaultMessage:"Settings"});return e.createElement(Xt.m,{ariaLabel:u},e.createElement(yn.p,{label:u}),e.createElement(vn.Z,null,C.map(I=>e.createElement(Qt.D,{key:I.id,label:d(I.intlLabel)},I.links.map(z=>e.createElement(Sn.E,{as:i.NavLink,withBullet:z.hasNotification,to:z.to,key:z.id},d(z.intlLabel)))))))};St.propTypes={menu:f().array.isRequired};const bn=St;function Ft(){const{settingId:g}=(0,i.useParams)(),{settings:d}=(0,h.useStrapiApp)(),{formatMessage:p}=(0,Y.useIntl)(),{isLoading:C,menu:u}=(0,se.Te)(),I=(0,e.useMemo)(()=>(0,Oe.WW)(En.map(({to:Ee,Component:J,exact:ye})=>(0,Oe.ot)(J,Ee,ye))),[]),z=fn(d);if(C)return e.createElement(h.LoadingIndicatorPage,null);if(!g)return e.createElement(i.Redirect,{to:"/settings/application-infos"});const W=p({id:"global.settings",defaultMessage:"Settings"});return e.createElement(te.A,{sideNav:e.createElement(bn,{menu:u})},e.createElement(Xe.Helmet,{title:W}),e.createElement(i.Switch,null,e.createElement(i.Route,{path:"/settings/application-infos",component:wt,exact:!0}),I,z))}const Wn=(0,e.memo)(Ft)},73871:(ee,b,t)=>{t.d(b,{Z:()=>te});var e=t(67294),h=t(49656);const te=()=>e.createElement(h.Redirect,{to:"/404"})},79578:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},56195:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},35820:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},53558:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},99047:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},28834:(ee,b,t)=>{t.d(b,{Z:()=>Mo});var e=t(67294),h=t(45697),i=t.n(h),te=t(68547),Y=t(82777),Xe=t(60633),se=t(42761),Oe=t(18721),Ze=t.n(Oe),Fe=t(41609),nt=t.n(Fe),H=t(97132),L=t(41580),T=t(71893),Re=t(89734),U=t.n(Re),Me=t(70885),$=t(66942),je=t(52337),_=t(41451),F=t(11047),qe=t(27361),G=t.n(qe),f=t(57557),ze=t.n(f),ie=t(48474),Ge=t(78114),we=t(29728);const ct=T.default.div`
  position: relative;

  ${({hasConditions:o,disabled:n,theme:a})=>o&&`
    &:before {
      content: '';
      position: absolute;
      top: -3px;
      left: -10px;
      width: 6px;
      height: 6px;
      border-radius: ${20/16}rem;;
      background: ${n?a.colors.neutral100:a.colors.primary600};
    }
  `}
`,_e=({onClick:o,className:n,hasConditions:a,variant:s})=>{const{formatMessage:l}=(0,H.useIntl)();return e.createElement(ct,{hasConditions:a,className:n},e.createElement(we.z,{variant:s,startIcon:e.createElement(Ge.Z,null),onClick:o},l({id:"global.settings",defaultMessage:"Settings"})))};_e.defaultProps={className:null,hasConditions:!1,variant:"tertiary"},_e.propTypes={onClick:i().func.isRequired,className:i().string,hasConditions:i().bool,variant:i().string};const Qe=(0,T.default)(_e)``;var st=t(42866),it=t(24969),ot=t(59946),le=t(36856),Ye=t(2407),pe=t(75515),ne=t(60612),w=t(7739),oe=t.n(w),K=t(11700),X=t.n(K),ge=t(38953);const he=o=>Object.values(o).map(n=>Object.entries(n).filter(([,a])=>a).map(([a])=>a)).flat(),De=o=>o.reduce((n,[a,s])=>(n.push({label:X()(a),children:s.map(l=>({label:l.displayName,value:l.id}))}),n),[]),Be=(o,n)=>o.map(([,a])=>a).flat().reduce((a,s)=>({[s.id]:n.includes(s.id),...a}),{});var re=function(){return window&&window.strapi&&window.strapi.isEE?t(53273).Z:t(79578).Z}(),Ue=function(n){var a=n.arrayOfOptionsGroupedByCategory,s=n.isFormDisabled,l=n.isGrey,r=n.label,c=n.name,m=n.onChange,y=n.value,v=(0,H.useIntl)(),S=v.formatMessage,A=function(B){m(c,Be(a,B))};return e.createElement(F.k,{as:"li",background:l?"neutral100":"neutral0",paddingBottom:3,paddingTop:3},e.createElement(F.k,{paddingLeft:6,style:{width:180}},e.createElement(pe.Z,{variant:"sigma",textColor:"neutral600"},S({id:"Settings.permissions.conditions.can",defaultMessage:"Can"}),"\xA0"),e.createElement(pe.Z,{variant:"sigma",title:r,textColor:"primary600",ellipsis:!0},S({id:"Settings.roles.form.permissions.".concat(r.toLowerCase()),defaultMessage:r})),e.createElement(pe.Z,{variant:"sigma",textColor:"neutral600"},"\xA0",S({id:"Settings.permissions.conditions.when",defaultMessage:"When"}))),e.createElement(L.x,{style:{maxWidth:430,width:"100%"}},e.createElement(ge.Q,{id:c,customizeContent:function(B){return"".concat(B.length," currently selected")},onChange:A,value:he(y),options:De(a),disabled:s||re})))};Ue.propTypes={arrayOfOptionsGroupedByCategory:i().array.isRequired,isFormDisabled:i().bool.isRequired,isGrey:i().bool.isRequired,label:i().string.isRequired,name:i().string.isRequired,value:i().object.isRequired,onChange:i().func.isRequired};const Ke=Ue;var E=t(96486);const Ve=(o,n)=>o.reduce((a,s)=>(a[s.id]=(0,E.get)(n,s.id,!1),a),{}),R=(o,n)=>o.reduce((a,s)=>{const[l,r]=s,c=Ve(r,n);return a[l]=c,a},{}),j=(o,n,a)=>o.reduce((s,l)=>{const r=(0,E.get)(n,[...l.pathToConditionsObject,"conditions"],{}),c=R(a,r);return s[l.pathToConditionsObject.join("..")]=c,s},{}),ce=({actions:o,headerBreadCrumbs:n,isFormDisabled:a,onClosed:s,onToggle:l})=>{const{formatMessage:r}=(0,H.useIntl)(),{availableConditions:c,modifiedData:m,onChangeConditions:y}=(0,ie.$_)(),v=(0,e.useMemo)(()=>Object.entries(oe()(c,"category")),[c]),S=o.filter(({isDisplayed:D,hasSomeActionsSelected:O,hasAllActionsSelected:k})=>D&&(O||k)),A=(0,e.useMemo)(()=>j(S,m,v),[S,m,v]),[x,B]=(0,e.useState)(A),P=(D,O)=>{B((0,ne.default)(k=>{k[D]||(k[D]={}),k[D].default||(k[D].default={}),k[D].default=O}))},N=()=>{const D=Object.entries(x).reduce((O,k)=>{const[ue,He]=k,Te=Object.values(He).reduce((ve,xe)=>({...ve,...xe}),{});return O[ue]=Te,O},{});y(D),l()};return e.createElement(st.P,{labelledBy:"condition-modal-breadcrumbs",onClose:s},e.createElement(it.x,null,e.createElement(Ye.O,{id:"condition-modal-breadcrumbs",label:n.join(", ")},n.map(D=>e.createElement(Ye.$,{key:D},X()(r({id:D,defaultMessage:D})))))),e.createElement(ot.f,null,S.length===0&&e.createElement(pe.Z,null,r({id:"Settings.permissions.conditions.no-actions",defaultMessage:"You first need to select actions (create, read, update, ...) before defining conditions on them."})),e.createElement("ul",null,S.map(({actionId:D,label:O,pathToConditionsObject:k},ue)=>{const He=k.join("..");return e.createElement(Ke,{key:D,arrayOfOptionsGroupedByCategory:v,label:O,isFormDisabled:a,isGrey:ue%2===0,name:He,onChange:P,value:G()(x,He,{})})}))),e.createElement(le.m,{startActions:e.createElement(we.z,{variant:"tertiary",onClick:l},r({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(we.z,{onClick:N},r({id:"Settings.permissions.conditions.apply",defaultMessage:"Apply"}))}))};ce.propTypes={actions:i().arrayOf(i().shape({actionId:i().string.isRequired,checkboxName:i().string,hasSomeActionsSelected:i().bool.isRequired,hasAllActionsSelected:i().bool,isDisplayed:i().bool.isRequired,label:i().string})).isRequired,headerBreadCrumbs:i().arrayOf(i().string).isRequired,isFormDisabled:i().bool.isRequired,onClosed:i().func.isRequired,onToggle:i().func.isRequired};const ae=ce,Q=`${120/16}rem`,Ce=`${200/16}rem`,$e=`${53/16}rem`,M=T.default.div`
  width: ${Q};
`,ut=(0,T.default)(F.k)`
  padding-right: ${({theme:o})=>o.spaces[2]};
  overflow: hidden;
  flex: 1;
  ${({isCollapsable:o})=>o&&"cursor: pointer;"}
`,Rt=({children:o,isCollapsable:n,isActive:a,isFormDisabled:s,label:l,onChange:r,onClick:c,checkboxName:m,someChecked:y,value:v})=>{const{formatMessage:S}=(0,H.useIntl)();return e.createElement(F.k,{alignItems:"center",paddingLeft:6,style:{width:Ce,flexShrink:0}},e.createElement(L.x,{paddingRight:2},e.createElement(_.C,{name:m,"aria-label":S({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:l}),disabled:s,onValueChange:A=>r({target:{name:m,value:A}}),indeterminate:y,value:v})),e.createElement(ut,{title:l,alignItems:"center",isCollapsable:n,...n&&{onClick:c,"aria-expanded":a,onKeyDown:({key:A})=>(A==="Enter"||A===" ")&&c(),tabIndex:0,role:"button"}},e.createElement(pe.Z,{fontWeight:a?"bold":"",textColor:a?"primary600":"neutral800",ellipsis:!0},X()(l)),o))};Rt.defaultProps={children:null,checkboxName:"",onChange(){},value:!1,someChecked:!1,isCollapsable:!1},Rt.propTypes={checkboxName:i().string,children:i().node,label:i().string.isRequired,isCollapsable:i().bool,isFormDisabled:i().bool.isRequired,onChange:i().func,onClick:i().func.isRequired,someChecked:i().bool,value:i().bool,isActive:i().bool.isRequired};const Nt=(0,e.memo)(Rt),Zt=o=>(0,E.isObject)(o)?(0,E.flattenDeep)(Object.values(o).map(n=>(0,E.isObject)(n)?Zt(n):n)):[],ft=Zt,ht=o=>o?Object.keys(o).reduce((n,a)=>(a!=="conditions"&&(n[a]=o[a]),n),{}):null,et=o=>{const n=ht(o),a=ft(n);if(!a.length)return{hasAllActionsSelected:!1,hasSomeActionsSelected:!1};const s=a.every(r=>r),l=a.some(r=>r)&&!s;return{hasAllActionsSelected:s,hasSomeActionsSelected:l}},qt=(o,n,a)=>o.map(({actionId:s,isDisplayed:l,applyToProperties:r,label:c})=>{if(!l)return{actionId:s,hasSomeActionsSelected:!1,isDisplayed:l};const m=[...a.split(".."),s],y=(0,E.isEmpty)(r)?[...m,"properties","enabled"]:m,v=y.join(".."),S=(0,E.get)(n,[...m,"conditions"],null),A=ft(S).some(N=>N);if((0,E.isEmpty)(r)){const N=(0,E.get)(n,y,!1);return{actionId:s,checkboxName:v,hasAllActionsSelected:N,hasConditions:A,hasSomeActionsSelected:N,isDisplayed:l,isParentCheckbox:!1,label:c,pathToConditionsObject:m}}const x=(0,E.get)(n,y,null),{hasAllActionsSelected:B,hasSomeActionsSelected:P}=et(x);return{actionId:s,checkboxName:v,hasAllActionsSelected:B,hasConditions:A,hasSomeActionsSelected:P,isDisplayed:l,isParentCheckbox:!0,label:c,pathToConditionsObject:m}});var _t=t(12645);const Ct=(0,T.default)(_t.default)`
  display: none;
  width: ${10/16}rem;
  transform: rotate(${({$isActive:o})=>o?"180":"0"}deg);
  margin-left: ${({theme:o})=>o.spaces[2]};
`,mt=o=>`
  ${pe.Z} {
    color: ${o.colors.primary600};
    font-weight: ${o.fontWeights.bold}
  }
  ${Ct} {
    display: block;
    path {
      fill: ${o.colors.primary600}
    };
  }
`;var jt=function(){return window&&window.strapi&&window.strapi.isEE?t(20591).Z:t(56195).Z}(),Mt=function o(n,a){return`
  `.concat(zt,` {
    background-color: `).concat(n.colors.primary100,`;
    color: `).concat(n.colors.primary600,`;
    border-radius: `).concat(a?"2px 2px 0 0":"2px",`;
  }
  `).concat(tn,` {
    display: flex;
  }
  `).concat(Qe,` {
    display: block;
  }
  &:hover {
   `).concat(mt(n),`
  }

  &:focus-within {
    `).concat(function(s){var l=s.theme,r=s.isActive;return o(l,r)},`
  }
  
`)},zt=T.default.div.withConfig({displayName:"Collapse__Wrapper",componentId:"sc-132fji1-0"})(["flex:1;display:flex;align-items:center;height:",";background-color:",";border:1px solid transparent;"],$e,function(o){var n=o.isGrey,a=o.theme;return n?a.colors.neutral100:a.colors.neutral0}),Dt=T.default.div.withConfig({displayName:"Collapse__BoxWrapper",componentId:"sc-132fji1-1"})(["display:inline-flex;min-width:100%;","{display:none;}"," &:hover{","}"],Qe,function(o){var n=o.isActive,a=o.theme;return n&&Mt(a,n)},function(o){var n=o.theme,a=o.isActive;return Mt(n,a)}),en=(0,T.default)(F.k).withConfig({displayName:"Collapse__Cell",componentId:"sc-132fji1-2"})(["width:",";position:relative;"],Q),tn=(0,T.default)(L.x).withConfig({displayName:"Collapse__Chevron",componentId:"sc-132fji1-3"})(["display:none;svg{width:11px;}*{fill:",";}"],function(o){var n=o.theme;return n.colors.primary600}),Ut=T.default.span.withConfig({displayName:"Collapse__TinyDot",componentId:"sc-132fji1-4"})(["position:absolute;top:-6px;left:37px;width:6px;height:6px;border-radius:20px;background:",";"],function(o){var n=o.theme;return n.colors.primary600}),Lt=(0,T.default)(L.x).withConfig({displayName:"Collapse__AbsoluteBox",componentId:"sc-132fji1-5"})(["position:absolute;right:9px;transform:translateY(10px);"]),xt=function(n){var a=n.availableActions,s=n.isActive,l=n.isGrey,r=n.isFormDisabled,c=n.label,m=n.onClickToggle,y=n.pathToData,v=(0,e.useState)(!1),S=(0,Me.Z)(v,2),A=S[0],x=S[1],B=(0,H.useIntl)(),P=B.formatMessage,N=(0,ie.$_)(),D=N.modifiedData,O=N.onChangeParentCheckbox,k=N.onChangeSimpleCheckbox,ue=function(){x(function(fe){return!fe})},He=function(){x(!1)},Te=G()(D,y.split(".."),{}),ve=(0,e.useMemo)(function(){return Object.keys(Te).reduce(function(q,fe){return q[fe]=ze()(Te[fe],"conditions"),q},{})},[Te]),xe=et(ve),Ae=xe.hasAllActionsSelected,yt=xe.hasSomeActionsSelected,me=(0,e.useMemo)(function(){return qt(a,D,y)},[a,D,y]),Pe=me.some(function(q){var fe=q.hasConditions;return fe});return e.createElement(Dt,{isActive:s},e.createElement(zt,{isGrey:l},e.createElement(Nt,{isCollapsable:!0,isFormDisabled:r,label:c,checkboxName:y,onChange:O,onClick:m,someChecked:yt,value:Ae,isActive:s},e.createElement(tn,{paddingLeft:2},s?e.createElement(je.Z,null):e.createElement($.Z,null))),e.createElement(F.k,{style:{flex:1}},me.map(function(q){var fe=q.actionId,Se=q.hasConditions,Ie=q.hasAllActionsSelected,Ne=q.hasSomeActionsSelected,gt=q.isDisplayed,ke=q.isParentCheckbox,rt=q.checkboxName,Tt=q.label;return gt?ke?e.createElement(en,{key:fe,justifyContent:"center",alignItems:"center"},Se&&e.createElement(Ut,null),e.createElement(_.C,{disabled:r||jt,name:rt,"aria-label":P({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(Tt," ").concat(c)}),onValueChange:function(vt){O({target:{name:rt,value:vt}})},indeterminate:Ne,value:Ie})):e.createElement(en,{key:fe,justifyContent:"center",alignItems:"center"},Se&&e.createElement(Ut,null),e.createElement(_.C,{disabled:r||jt,indeterminate:Se,name:rt,onValueChange:function(vt){k({target:{name:rt,value:vt}})},value:Ie})):e.createElement(M,{key:fe})})),A&&e.createElement(ae,{headerBreadCrumbs:[c,"Settings.permissions.conditions.conditions"],actions:me,isFormDisabled:r,onClosed:He,onToggle:ue})),e.createElement(Lt,null,e.createElement(Qe,{onClick:ue,hasConditions:Pe})))};xt.propTypes={availableActions:i().array.isRequired,isActive:i().bool.isRequired,isGrey:i().bool.isRequired,isFormDisabled:i().bool.isRequired,label:i().string.isRequired,onClickToggle:i().func.isRequired,pathToData:i().string.isRequired};const Pt=xt,nn=(o,n)=>o.map(a=>{const s=Array.isArray(a.applyToProperties)&&a.applyToProperties.indexOf(n)!==-1&&a.isDisplayed;return{label:a.label,actionId:a.actionId,isActionRelatedToCurrentProperty:s}}),$t=(0,T.default)(F.k)`
  width: ${Q};
  flex-shrink: 0;
`,on=(0,T.default)(F.k)`
  width: ${Ce};
  height: ${$e};
  flex-shrink: 0;
`,an=({headers:o,label:n})=>{const{formatMessage:a}=(0,H.useIntl)(),s=a({id:"Settings.roles.form.permission.property-label",defaultMessage:"{label} permissions"},{label:n});return e.createElement(F.k,null,e.createElement(on,{alignItems:"center",paddingLeft:6},e.createElement(pe.Z,{variant:"sigma",textColor:"neutral500"},s)),o.map(l=>l.isActionRelatedToCurrentProperty?e.createElement($t,{justifyContent:"center",key:l.label},e.createElement(pe.Z,{variant:"sigma",textColor:"neutral500"},a({id:`Settings.roles.form.permissions.${l.label.toLowerCase()}`,defaultMessage:l.label}))):e.createElement($t,{key:l.label})))};an.propTypes={headers:i().arrayOf(i().shape({label:i().string.isRequired,isActionRelatedToCurrentProperty:i().bool.isRequired})).isRequired,label:i().string.isRequired};const sn=an;var pt=t(42982);const ln=T.default.span`
  color: ${({theme:o})=>o.colors.danger700};
  padding-left: ${({theme:o})=>o.spaces[1]}px;
`,Wt=()=>e.createElement(ln,null,"*"),jn=(o,n)=>o.map(a=>{const s=Array.isArray(a.subjects)&&a.subjects.indexOf(n)!==-1;return{...a,isDisplayed:s}});var kt=t(87462);const cn=(0,T.default)(L.x)`
  transform: translate(-4px, -12px);

  &:before {
    content: '';
    width: ${4/16}rem;
    height: ${12/16}rem;
    background: ${({theme:o})=>o.colors.primary200};
    display: block;
  }
`,dn=T.default.svg`
  position: relative;
  flex-shrink: 0;
  transform: translate(-0.5px, -1px);

  * {
    fill: ${({theme:o,color:n})=>o.colors[n]};
  }
`,Gt=o=>e.createElement(cn,null,e.createElement(dn,{width:"20",height:"23",viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o},e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.02477 14.7513C8.65865 17.0594 11.6046 18.6059 17.5596 18.8856C18.6836 18.9384 19.5976 19.8435 19.5976 20.9688V20.9688C19.5976 22.0941 18.6841 23.0125 17.5599 22.9643C10.9409 22.6805 6.454 20.9387 3.75496 17.1258C0.937988 13.1464 0.486328 7.39309 0.486328 0.593262H4.50974C4.50974 7.54693 5.06394 11.9813 7.02477 14.7513Z",fill:"#D9D8FF"})));Gt.defaultProps={fill:"primary200"},Gt.propTypes={fill:i().string};const un=(0,e.memo)(Gt);var mn=function(){return window&&window.strapi&&window.strapi.isEE?t(76766).Z:t(53558).Z}(),wt=(0,T.default)(F.k).withConfig({displayName:"SubActionRow__Cell",componentId:"sc-7y8yzq-0"})(["width:",";position:relative;"],Q),pn=(0,T.default)(F.k).withConfig({displayName:"SubActionRow__RowWrapper",componentId:"sc-7y8yzq-1"})(["height:",";"],$e),gn=(0,T.default)(L.x).withConfig({displayName:"SubActionRow__Wrapper",componentId:"sc-7y8yzq-2"})(["padding-left:","rem;"],31/16),zn=(0,T.default)(L.x).withConfig({displayName:"SubActionRow__LeftBorderTimeline",componentId:"sc-7y8yzq-3"})(["border-left:",";"],function(o){var n=o.isVisible,a=o.theme;return n?"4px solid ".concat(a.colors.primary200):"4px solid transparent"}),fn=(0,T.default)(F.k).withConfig({displayName:"SubActionRow__RowStyle",componentId:"sc-7y8yzq-4"})(["padding-left:",";width:","px;"," ",";"],function(o){var n=o.theme;return n.spaces[4]},function(o){var n=o.level;return 145-n*36},function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(Ct,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(mt(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&mt(a)}),Un=T.default.div.withConfig({displayName:"SubActionRow__TopTimeline",componentId:"sc-7y8yzq-5"})(["padding-top:",";margin-top:",";width:","rem;background-color:",";border-top-left-radius:2px;border-top-right-radius:2px;"],function(o){var n=o.theme;return n.spaces[2]},function(o){var n=o.theme;return n.spaces[2]},4/16,function(o){var n=o.theme;return n.colors.primary200}),Kt=function o(n){var a=n.childrenForm,s=n.isFormDisabled,l=n.recursiveLevel,r=n.pathToDataFromActionRow,c=n.propertyActions,m=n.parentName,y=n.propertyName,v=(0,H.useIntl)(),S=v.formatMessage,A=(0,ie.$_)(),x=A.modifiedData,B=A.onChangeParentCheckbox,P=A.onChangeSimpleCheckbox,N=(0,e.useState)(null),D=(0,Me.Z)(N,2),O=D[0],k=D[1],ue=function(ve){k(function(xe){return xe===ve?null:ve})},He=(0,e.useMemo)(function(){return O?a.find(function(Te){var ve=Te.value;return ve===O}):null},[O,a]);return e.createElement(gn,null,e.createElement(Un,null),a.map(function(Te,ve){var xe=Te.label,Ae=Te.value,yt=Te.required,me=Te.children,Pe=ve+1<a.length,q=Array.isArray(me),fe=O===Ae;return e.createElement(zn,{key:Ae,isVisible:Pe},e.createElement(pn,null,e.createElement(un,{color:"primary200"}),e.createElement(F.k,{style:{flex:1}},e.createElement(fn,{level:l,isActive:fe,isCollapsable:q},e.createElement(ut,(0,kt.Z)({alignItems:"center",isCollapsable:q},q&&{onClick:function(){return ue(Ae)},"aria-expanded":fe,onKeyDown:function(Ie){var Ne=Ie.key;return(Ne==="Enter"||Ne===" ")&&ue(Ae)},tabIndex:0,role:"button"},{title:xe}),e.createElement(pe.Z,{ellipsis:!0},X()(xe)),yt&&e.createElement(Wt,null),e.createElement(Ct,{$isActive:fe}))),e.createElement(F.k,{style:{flex:1}},c.map(function(Se){var Ie=Se.actionId,Ne=Se.label,gt=Se.isActionRelatedToCurrentProperty;if(!gt)return e.createElement(M,{key:Ie});var ke=[].concat((0,pt.Z)(r.split("..")),[Ie,"properties",y],(0,pt.Z)(m.split("..")),[Ae]),rt=G()(x,ke,!1);if(!me)return e.createElement(wt,{key:Ne,justifyContent:"center",alignItems:"center"},e.createElement(_.C,{disabled:s||mn,name:ke.join(".."),"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(m," ").concat(xe," ").concat(Ne)}),onValueChange:function(Bt){P({target:{name:ke.join(".."),value:Bt}})},value:rt}));var Tt=et(rt),At=Tt.hasAllActionsSelected,vt=Tt.hasSomeActionsSelected;return e.createElement(wt,{key:Ne,justifyContent:"center",alignItems:"center"},e.createElement(_.C,{key:Ne,disabled:s||mn,name:ke.join(".."),"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(m," ").concat(xe," ").concat(Ne)}),onValueChange:function(Bt){B({target:{name:ke.join(".."),value:Bt}})},value:At,indeterminate:vt}))})))),He&&fe&&e.createElement(L.x,{paddingBottom:2},e.createElement(o,{isFormDisabled:s,parentName:"".concat(m,"..").concat(Ae),pathToDataFromActionRow:r,propertyActions:c,propertyName:y,recursiveLevel:l+1,childrenForm:He.children})))}))};Kt.propTypes={childrenForm:i().array.isRequired,isFormDisabled:i().bool.isRequired,parentName:i().string.isRequired,pathToDataFromActionRow:i().string.isRequired,propertyActions:i().array.isRequired,propertyName:i().string.isRequired,recursiveLevel:i().number.isRequired};const Vt=(0,e.memo)(Kt),tt=o=>o.reduce((a,s)=>(s.isActionRelatedToCurrentProperty&&a.push(s.actionId),a),[]),de=(o,n,a,s,l)=>{const c=tt(o).reduce((m,y)=>{const v=[...a.split(".."),y,"properties",s,l],S=(0,E.get)(n,v,!1);return m[y]=S,m},{});return et(c)};var It=function(){return window&&window.strapi&&window.strapi.isEE?t(74512).Z:t(35820).Z}(),Ht=(0,T.default)(F.k).withConfig({displayName:"ActionRow__Cell",componentId:"sc-4agenc-0"})(["width:",";position:relative;"],Q),hn=(0,T.default)(F.k).withConfig({displayName:"ActionRow__Wrapper",componentId:"sc-4agenc-1"})(["height:",";flex:1;"," ",";"],$e,function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(Ct,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(mt(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&mt(a)}),Ot=function(n){var a=n.childrenForm,s=n.label,l=n.isFormDisabled,r=n.name,c=n.required,m=n.pathToData,y=n.propertyActions,v=n.propertyName,S=n.isOdd,A=(0,H.useIntl)(),x=A.formatMessage,B=(0,e.useState)(null),P=(0,Me.Z)(B,2),N=P[0],D=P[1],O=(0,ie.$_)(),k=O.modifiedData,ue=O.onChangeCollectionTypeLeftActionRowCheckbox,He=O.onChangeParentCheckbox,Te=O.onChangeSimpleCheckbox,ve=N===r,xe=(0,e.useMemo)(function(){return Array.isArray(a)?a:[]},[a]),Ae=xe.length>0,yt=(0,e.useCallback)(function(){Ae&&D(function(Se){return Se===r?null:r})},[Ae,r]),me=function(Ie){var Ne=Ie.target.value;ue(m,v,r,Ne)},Pe=(0,e.useMemo)(function(){return de(y,k,m,v,r)},[y,k,m,v,r]),q=Pe.hasAllActionsSelected,fe=Pe.hasSomeActionsSelected;return e.createElement(e.Fragment,null,e.createElement(hn,{alignItems:"center",isCollapsable:Ae,isActive:ve,background:S?"neutral100":"neutral0"},e.createElement(F.k,null,e.createElement(Nt,{onChange:me,onClick:yt,isCollapsable:Ae,isFormDisabled:l,label:s,someChecked:fe,value:q,isActive:ve},c&&e.createElement(Wt,null),e.createElement(Ct,{$isActive:ve})),e.createElement(F.k,null,y.map(function(Se){var Ie=Se.label,Ne=Se.isActionRelatedToCurrentProperty,gt=Se.actionId;if(!Ne)return e.createElement(M,{key:Ie});var ke=[].concat((0,pt.Z)(m.split("..")),[gt,"properties",v,r]);if(!Ae){var rt=G()(k,ke,!1);return e.createElement(Ht,{key:gt,justifyContent:"center",alignItems:"center"},e.createElement(_.C,{disabled:l||It,name:ke.join(".."),"aria-label":x({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(r," ").concat(Ie)}),onValueChange:function(Pn){Te({target:{name:ke.join(".."),value:Pn}})},value:rt}))}var Tt=G()(k,ke,{}),At=et(Tt),vt=At.hasAllActionsSelected,xn=At.hasSomeActionsSelected;return e.createElement(Ht,{key:Ie,justifyContent:"center",alignItems:"center"},e.createElement(_.C,{disabled:l||It,name:ke.join(".."),onValueChange:function(Pn){He({target:{name:ke.join(".."),value:Pn}})},"aria-label":x({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(r," ").concat(Ie)}),value:vt,indeterminate:xn}))})))),ve&&e.createElement(Vt,{childrenForm:xe,isFormDisabled:l,parentName:r,pathToDataFromActionRow:m,propertyName:v,propertyActions:y,recursiveLevel:0}))};Ot.defaultProps={childrenForm:[],required:!1},Ot.propTypes={childrenForm:i().array,label:i().string.isRequired,isFormDisabled:i().bool.isRequired,name:i().string.isRequired,pathToData:i().string.isRequired,propertyActions:i().array.isRequired,propertyName:i().string.isRequired,required:i().bool,isOdd:i().bool.isRequired};const Cn=(0,e.memo)(Ot),En=T.default.div`
  display: inline-flex;
  flex-direction: column;
  min-width: 0;
`,Xt=({availableActions:o,childrenForm:n,isFormDisabled:a,label:s,pathToData:l,propertyName:r})=>{const c=(0,e.useMemo)(()=>nn(o,r),[o,r]);return e.createElement(En,null,e.createElement(sn,{label:s,headers:c}),e.createElement(L.x,null,n.map(({children:m,label:y,value:v,required:S},A)=>e.createElement(Cn,{childrenForm:m,key:v,label:y,isFormDisabled:a,name:v,required:S,propertyActions:c,pathToData:l,propertyName:r,isOdd:A%2===0}))))};Xt.propTypes={childrenForm:i().array.isRequired,availableActions:i().array.isRequired,isFormDisabled:i().bool.isRequired,label:i().string.isRequired,pathToData:i().string.isRequired,propertyName:i().string.isRequired};const yn=Xt,vn=T.default.div`
  flex-direction: column;
  display: inline-flex;
  min-width: 100%;
  ${({theme:o,isActive:n})=>n&&`border: 1px solid ${o.colors.primary600};`}
`,Qt=({allActions:o,contentTypeName:n,label:a,index:s,isActive:l,isFormDisabled:r,onClickToggleCollapse:c,pathToData:m,properties:y})=>{const v=(0,e.useCallback)(()=>{c(n)},[n,c]),S=(0,e.useMemo)(()=>jn(o,n),[o,n]);return e.createElement(vn,{isActive:l},e.createElement(Pt,{availableActions:S,isActive:l,isGrey:s%2===0,isFormDisabled:r,label:a,onClickToggle:v,pathToData:m}),l&&y.map(({label:A,value:x,children:B})=>e.createElement(yn,{availableActions:S,childrenForm:B,isFormDisabled:r,label:A,pathToData:m,propertyName:x,key:x})))};Qt.propTypes={allActions:i().array.isRequired,contentTypeName:i().string.isRequired,index:i().number.isRequired,isActive:i().bool.isRequired,isFormDisabled:i().bool.isRequired,label:i().string.isRequired,onClickToggleCollapse:i().func.isRequired,pathToData:i().string.isRequired,properties:i().array.isRequired};const Sn=Qt,St=({actions:o,isFormDisabled:n,pathToData:a,subjects:s})=>{const[l,r]=(0,e.useState)(null),c=m=>{r(l===m?null:m)};return s.map(({uid:m,label:y,properties:v},S)=>e.createElement(Sn,{allActions:o,key:m,contentTypeName:m,label:y,isActive:l===m,isFormDisabled:n,index:S,onClickToggleCollapse:c,pathToData:`${a}..${m}`,properties:v}))};St.defaultProps={actions:[],subjects:[]},St.propTypes={actions:i().array.isRequired,isFormDisabled:i().bool.isRequired,pathToData:i().string.isRequired,subjects:i().arrayOf(i().shape({uid:i().string.isRequired,label:i().string.isRequired,properties:i().array.isRequired}))};const bn=(0,e.memo)(St);var Ft=t(7681);const g=o=>o.filter(({subjects:n})=>n&&n.length),d=o=>o.map(({actionId:n})=>n),p=(o,n)=>o.reduce((a,s)=>(Object.keys(n).forEach(l=>{const r=(0,E.get)(n,[l,s],{}),c={[l]:ht(r)};a[s]?a[s]={...a[s],...c}:a[s]=c}),a),{}),u=(o,n)=>{const a=d(o),s=p(a,n);return Object.keys(s).reduce((r,c)=>(r[c]=et(s[c]),r),{})};var I=function(){return window&&window.strapi&&window.strapi.isEE?t(85822).Z:t(99047).Z}(),z=(0,T.default)(Ft.K).withConfig({displayName:"GlobalActions__CenteredStack",componentId:"sc-1vxwsjr-0"})(["align-items:center;justify-content:center;width:",";flex-shrink:0;"],Q),W=function(n){var a=n.actions,s=n.isFormDisabled,l=n.kind,r=(0,H.useIntl)(),c=r.formatMessage,m=(0,ie.$_)(),y=m.modifiedData,v=m.onChangeCollectionTypeGlobalActionCheckbox,S=(0,e.useMemo)(function(){return g(a)},[a]),A=(0,e.useMemo)(function(){return u(S,y[l])},[y,S,l]);return e.createElement(L.x,{paddingBottom:4,paddingTop:6,style:{paddingLeft:Ce}},e.createElement(Ft.K,{horizontal:!0,spacing:0},S.map(function(x){var B=x.label,P=x.actionId;return e.createElement(z,{key:P,spacing:3},e.createElement(pe.Z,{variant:"sigma",textColor:"neutral500"},c({id:"Settings.roles.form.permissions.".concat(B.toLowerCase()),defaultMessage:B})),e.createElement(_.C,{disabled:s||I,onValueChange:function(D){v(l,P,D)},name:P,"aria-label":c({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:c({id:"Settings.roles.form.permissions.".concat(B.toLowerCase()),defaultMessage:B})}),value:G()(A,[P,"hasAllActionsSelected"],!1),indeterminate:G()(A,[P,"hasSomeActionsSelected"],!1)}))})))};W.defaultProps={actions:[]},W.propTypes={actions:i().arrayOf(i().shape({label:i().string.isRequired,actionId:i().string.isRequired,subjects:i().array.isRequired})),isFormDisabled:i().bool.isRequired,kind:i().string.isRequired};const Ee=(0,e.memo)(W),J=(0,T.default)(L.x)`
  overflow-x: auto;
`,ye=({isFormDisabled:o,kind:n,layout:{actions:a,subjects:s}})=>{const l=U()([...s],"label");return e.createElement(J,{background:"neutral0"},e.createElement(Ee,{actions:a,kind:n,isFormDisabled:o}),e.createElement(bn,{actions:a,isFormDisabled:o,pathToData:n,subjects:l}))};ye.propTypes={isFormDisabled:i().bool.isRequired,kind:i().string.isRequired,layout:i().shape({actions:i().array,subjects:i().arrayOf(i().shape({uid:i().string.isRequired,label:i().string.isRequired,properties:i().array.isRequired}))}).isRequired};const V=(0,e.memo)(ye);var We=t(47713);const Le=({children:o,value:n})=>e.createElement(We.$l.Provider,{value:n},o);Le.propTypes={children:i().node.isRequired,value:i().exact({availableConditions:i().array.isRequired,modifiedData:i().object.isRequired,onChangeCollectionTypeLeftActionRowCheckbox:i().func.isRequired,onChangeConditions:i().func.isRequired,onChangeSimpleCheckbox:i().func.isRequired,onChangeParentCheckbox:i().func.isRequired,onChangeCollectionTypeGlobalActionCheckbox:i().func.isRequired}).isRequired};const Je=Le;var at=t(48734),lt=t(74756),Et=t(63081),bt=t(11276),Tn=t(74571),Yt=t(36213);const so=(o,n,a)=>o.map(s=>{const l=[...a,s.action,"properties","enabled"],r=(0,E.get)(n,l,!1),c=(0,E.get)(n,[...a,s.action,"conditions"],{}),m=ft(c).some(y=>y);return{...s,isDisplayed:r,checkboxName:l.join(".."),hasSomeActionsSelected:r,value:r,hasConditions:m,label:s.displayName,actionId:s.action,pathToConditionsObject:[...a,s.action]}}),io=o=>{const n=Object.entries(o).reduce((s,l)=>{const[r,{conditions:c}]=l;return s[r]=c,s},{});return ft(n).some(s=>s)};var An=function(){return window&&window.strapi&&window.strapi.isEE?t(8629).Z:t(34341).Z}(),lo=T.default.div.withConfig({displayName:"SubCategory__Border",componentId:"sc-akgczm-0"})(["flex:1;align-self:center;border-top:1px solid ",";"],function(o){var n=o.theme;return n.colors.neutral150}),ro=T.default.div.withConfig({displayName:"SubCategory__CheckboxWrapper",componentId:"sc-akgczm-1"})(["position:relative;word-break:keep-all;",""],function(o){var n=o.hasConditions,a=o.disabled,s=o.theme;return n&&`
    &:before {
      content: '';
      position: absolute;
      top: `.concat(-4/16,`rem;
      left: `).concat(-8/16,`rem;
      width: `).concat(6/16,`rem;
      height: `).concat(6/16,`rem;
      border-radius: `).concat(20/16,`rem;
      background: `).concat(a?s.colors.neutral100:s.colors.primary600,`;
    }
  `)}),Gn=function(n){var a=n.categoryName,s=n.isFormDisabled,l=n.subCategoryName,r=n.actions,c=n.pathToData,m=(0,e.useState)(!1),y=(0,Me.Z)(m,2),v=y[0],S=y[1],A=(0,ie.$_)(),x=A.modifiedData,B=A.onChangeParentCheckbox,P=A.onChangeSimpleCheckbox,N=(0,H.useIntl)(),D=N.formatMessage,O=G()(x,c,{}),k=(0,e.useMemo)(function(){return Object.keys(O).reduce(function(me,Pe){return me[Pe]=ht(O[Pe]),me},{})},[O]),ue=et(k),He=ue.hasAllActionsSelected,Te=ue.hasSomeActionsSelected,ve=function(){S(function(Pe){return!Pe})},xe=function(){S(!1)},Ae=so(r,x,c),yt=io(G()(x,(0,pt.Z)(c),{}));return e.createElement(e.Fragment,null,e.createElement(L.x,null,e.createElement(F.k,{justifyContent:"space-between",alignItems:"center"},e.createElement(L.x,{paddingRight:4},e.createElement(pe.Z,{variant:"sigma",textColor:"neutral600"},l)),e.createElement(lo,null),e.createElement(L.x,{paddingLeft:4},e.createElement(Yt.X,{name:c.join(".."),disabled:s||An,onValueChange:function(Pe){B({target:{name:c.join(".."),value:Pe}})},indeterminate:Te,value:He},D({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(F.k,{paddingTop:6,paddingBottom:6},e.createElement(bt.r,{gap:2,style:{flex:1}},Ae.map(function(me){var Pe=me.checkboxName,q=me.value,fe=me.action,Se=me.displayName,Ie=me.hasConditions;return e.createElement(Tn.P,{col:3,key:fe},e.createElement(ro,{disabled:s||An,hasConditions:Ie},e.createElement(Yt.X,{name:Pe,disabled:s||An,onValueChange:function(gt){P({target:{name:Pe,value:gt}})},value:q},Se)))})),e.createElement(Qe,{hasConditions:yt,onClick:ve}))),v&&e.createElement(ae,{headerBreadCrumbs:[a,l],actions:Ae,isFormDisabled:s,onClosed:xe,onToggle:ve}))};Gn.propTypes={actions:i().array.isRequired,categoryName:i().string.isRequired,isFormDisabled:i().bool.isRequired,subCategoryName:i().string.isRequired,pathToData:i().array.isRequired};const co=Gn,Rn=({childrenForm:o,kind:n,name:a,isOpen:s,isFormDisabled:l,isWhite:r,onOpenCategory:c,pathToData:m})=>{const{formatMessage:y}=(0,H.useIntl)(),v=()=>{c(a)},S=(0,e.useMemo)(()=>a.split("::").pop(),[a]);return e.createElement(at.U,{expanded:s,onToggle:v,id:`accordion-${a}`,variant:r?"primary":"secondary"},e.createElement(lt.B,{title:X()(S),description:`${y({id:"Settings.permissions.category"},{category:S})} ${n==="plugins"?"plugin":n}`}),e.createElement(Et.v,null,e.createElement(L.x,{padding:6},o.map(({actions:A,subCategoryName:x,subCategoryId:B})=>e.createElement(co,{key:x,actions:A,categoryName:S,isFormDisabled:l,subCategoryName:x,pathToData:[...m,B]})))))};Rn.defaultProps={},Rn.propTypes={childrenForm:i().array.isRequired,isOpen:i().bool.isRequired,isFormDisabled:i().bool.isRequired,isWhite:i().bool.isRequired,kind:i().string.isRequired,name:i().string.isRequired,onOpenCategory:i().func.isRequired,pathToData:i().array.isRequired};const uo=Rn,wn=({isFormDisabled:o,kind:n,layout:a})=>{const[s,l]=(0,e.useState)(null),r=c=>{l(c===s?null:c)};return e.createElement(L.x,{padding:6,background:"neutral0"},a.map(({category:c,categoryId:m,childrenForm:y},v)=>e.createElement(uo,{key:c,childrenForm:y,kind:n,isFormDisabled:o,isOpen:s===c,isWhite:v%2===1,name:c,onOpenCategory:r,pathToData:[n,m]})))};wn.propTypes={isFormDisabled:i().bool.isRequired,kind:i().string.isRequired,layout:i().arrayOf(i().shape({category:i().string.isRequired,categoryId:i().string.isRequired,childrenForm:i().arrayOf(i().shape({actions:i().array.isRequired})).isRequired}).isRequired).isRequired};const Kn=wn,Vn=(o,n,a)=>o.find(s=>s.action===n&&s.subject===a),Hn=(o,n=[])=>o.reduce((a,s)=>(a[s.id]=n.indexOf(s.id)!==-1,a),{}),Xn=({children:o},n,a="")=>o.reduce((s,l)=>{if(l.children)return{...s,[l.value]:Xn(l,n,`${a}${l.value}.`)};const r=n.indexOf(`${a}${l.value}`)!==-1;return s[l.value]=r,s},{}),mo=(o,n,a)=>o.reduce((s,l)=>{const r=n.properties.find(({value:c})=>c===l);if(r){const c=(0,E.get)(a,["properties",r.value],[]),m=Xn(r,c);s.properties[l]=m}return s},{properties:{}}),po=(o,n)=>n.reduce((a,s)=>{const l=o.find(({uid:r})=>r===s)||null;return l&&(a[s]=l),a},{}),Qn=({subjects:o},n,a,s=[])=>n.reduce((l,r)=>{const c=r.subjects,m=po(o,c);if((0,E.isEmpty)(m))return l;const y=Object.keys(m).reduce((v,S)=>{const{actionId:A,applyToProperties:x}=r,N=m[S].properties.map(({value:ue})=>ue).every(ue=>(x||[]).indexOf(ue)===-1),D=Vn(s,A,S),O=Hn(a,(0,E.get)(D,"conditions",[]));if((0,E.isEmpty)(x)||N)return(0,E.set)(v,[S,A],{properties:{enabled:D!==void 0},conditions:O}),v;const k=mo(x,m[S],D);return(0,E.set)(v,[S,A],{...k,conditions:O}),v},{});return(0,E.merge)(l,y)},{}),go=(o,n,a)=>o.reduce((s,l)=>{const r=Vn(a,l.action,null);return s[l.action]={properties:{enabled:r!==void 0},conditions:Hn(n,(0,E.get)(r,"conditions",[]))},s},{}),fo=(o,n,a)=>o.reduce((s,l)=>(s[l.subCategoryId]=go(l.actions,n,a),s),{}),Yn=(o,n,a=[])=>o.reduce((s,{categoryId:l,childrenForm:r})=>{const c=fo(r,n,a);return s[l]=c,s},{}),Jn=o=>o.split(" ").join("-"),qn=(o,n)=>(0,E.chain)(o).groupBy(n).map((a,s)=>({category:s,categoryId:Jn(s),childrenForm:(0,E.chain)(a).groupBy("subCategory").map((l,r)=>({subCategoryName:r,subCategoryId:Jn(r),actions:l})).value()})).value(),ho=(o,n)=>{const{conditions:a,sections:{collectionTypes:s,singleTypes:l,plugins:r,settings:c}}=o,m={collectionTypes:s,singleTypes:l,plugins:qn(r,"plugin"),settings:qn(c,"category")},y={collectionTypes:Qn(s,s.actions||[],a,n),singleTypes:Qn(l,l.actions||[],a,n),plugins:Yn(m.plugins,a,n),settings:Yn(m.settings,a,n)};return{initialData:y,modifiedData:y,layouts:m}},_n=o=>Object.keys(o).reduce((n,a)=>{const s=o[a];if((0,E.isObject)(s)&&!(0,E.has)(s,"conditions"))return{...n,[a]:_n(s)};if((0,E.isObject)(s)&&(0,E.has)(s,"conditions")&&!ft((0,E.omit)(s,"conditions")).some(r=>r)){const r=Object.keys(s.conditions).reduce((c,m)=>(c[m]=!1,c),{});return{...n,[a]:{...s,conditions:r}}}return n[a]=s,n},{}),Mn=_n,eo=(o,n)=>Object.keys(o).reduce((a,s)=>{const l=o[s];return s==="conditions"?(a[s]=l,a):(0,E.isObject)(l)?{...a,[s]:eo(l,n)}:(a[s]=n,a)},{}),Jt=eo,Co={initialData:{},modifiedData:{},layouts:{}},Eo=(o,n)=>(0,ne.default)(o,a=>{switch(n.type){case"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX":{const{collectionTypeKind:s,actionId:l,value:r}=n,c=["modifiedData",s];Object.keys((0,E.get)(o,c)).forEach(m=>{const y=(0,E.get)(o,[...c,m,l],void 0);if(y){let v=Jt(y,r);if(!r&&v.conditions){const S=Jt(v.conditions,!1);v={...v,conditions:S}}(0,E.set)(a,[...c,m,l],v)}});break}case"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX":{const{pathToCollectionType:s,propertyName:l,rowName:r,value:c}=n;let m=(0,E.cloneDeep)(o.modifiedData);const y=s.split(".."),v=(0,E.get)(m,y,{});Object.keys(v).forEach(S=>{if((0,E.has)(v[S],`properties.${l}`)){const A=(0,E.get)(v,[S,"properties",l,r]),x=[...y,S,"properties",l,r];if(!(0,E.isObject)(A))(0,E.set)(m,x,c);else{const B=Jt(A,c);(0,E.set)(m,x,B)}}}),c||(m=Mn(m)),(0,E.set)(a,"modifiedData",m);break}case"ON_CHANGE_CONDITIONS":{Object.entries(n.conditions).forEach(s=>{const[l,r]=s;(0,E.set)(a,["modifiedData",...l.split(".."),"conditions"],r)});break}case"ON_CHANGE_SIMPLE_CHECKBOX":{let s=(0,E.cloneDeep)(o.modifiedData);(0,E.set)(s,[...n.keys.split("..")],n.value),n.value||(s=Mn(s)),(0,E.set)(a,"modifiedData",s);break}case"ON_CHANGE_TOGGLE_PARENT_CHECKBOX":{const{keys:s,value:l}=n,r=[...s.split("..")];let c=(0,E.cloneDeep)(o.modifiedData);const m=(0,E.get)(c,r,{}),y=Jt(m,l);(0,E.set)(c,r,y),l||(c=Mn(c)),(0,E.set)(a,["modifiedData"],c);break}case"RESET_FORM":{a.modifiedData=o.initialData;break}case"SET_FORM_AFTER_SUBMIT":{a.initialData=o.modifiedData;break}default:return a}}),Dn=o=>Object.entries(o).filter(([,n])=>n).map(([n])=>n),yo=o=>{const[n,{conditions:a}]=o;return{action:n,subject:null,conditions:Dn(a),properties:{}}},vo=o=>Object.values(o).reduce((n,a)=>{const s=Object.entries(a).reduce((l,r)=>{const[,{properties:{enabled:c}}]=r;if(!c)return l;const m=yo(r);return l.push(m),l},[]);return[...n,...s]},[]),to=o=>Object.values(o).reduce((n,a)=>{const s=vo(a);return[...n,...s]},[]),no=(o,n="")=>Object.entries(o).reduce((a,s)=>{const[l,r]=s;return(0,E.isObject)(r)?[...a,...no(r,`${n}${l}.`)]:(r&&!(0,E.isObject)(r)&&a.push(`${n}${l}`),a)},[]),So=(o,n,{conditions:a,properties:s})=>Object.entries(s).reduce((l,r)=>{const[c,m]=r;return l.properties[c]=no(m),l},{action:o,subject:n,conditions:Dn(a),properties:{}}),bo=(o,n,{conditions:a})=>({action:o,subject:n,properties:{},conditions:Dn(a)}),To=(o,n)=>Object.entries(n).reduce((s,l)=>{const[r,c]=l;if(!ft(c).some(v=>v))return s;if(!(0,E.has)(c,"properties.enabled")){const v=So(r,o,c);return[...s,v]}if(!c.properties.enabled)return s;const y=bo(r,o,c);return s.push(y),s},[]),oo=o=>Object.entries(o).reduce((a,s)=>{const[l,r]=s,c=To(l,r);return[...a,...c]},[]),Ao=o=>{const n=to(o.plugins),a=to(o.settings),s=oo(o.collectionTypes),l=oo(o.singleTypes);return[...n,...a,...s,...l]},Ro=[{labelId:"app.components.LeftMenuLinkContainer.collectionTypes",defaultMessage:"Collection Types",id:"collectionTypes"},{labelId:"app.components.LeftMenuLinkContainer.singleTypes",id:"singleTypes",defaultMessage:"Single Types"},{labelId:"app.components.LeftMenuLinkContainer.plugins",defaultMessage:"Plugins",id:"plugins"},{labelId:"app.components.LeftMenuLinkContainer.settings",defaultMessage:"Settings",id:"settings"}],Ln=(0,e.forwardRef)(({layout:o,isFormDisabled:n,permissions:a},s)=>{const[{initialData:l,layouts:r,modifiedData:c},m]=(0,e.useReducer)(Eo,Co,()=>ho(o,a)),{formatMessage:y}=(0,H.useIntl)();(0,e.useImperativeHandle)(s,()=>({getPermissions(){const P=(0,te.difference)(l.collectionTypes,c.collectionTypes),N=(0,te.difference)(l.singleTypes,c.singleTypes),D={...P,...N};let O;return nt()(D)?O=!1:O=Object.values(D).some(k=>Object.values(k).some(ue=>Ze()(ue,"conditions"))),{permissionsToSend:Ao(c),didUpdateConditions:O}},resetForm(){m({type:"RESET_FORM"})},setFormAfterSubmit(){m({type:"SET_FORM_AFTER_SUBMIT"})}}));const v=(P,N,D,O)=>{m({type:"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX",pathToCollectionType:P,propertyName:N,rowName:D,value:O})},S=(P,N,D)=>{m({type:"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX",collectionTypeKind:P,actionId:N,value:D})},A=P=>{m({type:"ON_CHANGE_CONDITIONS",conditions:P})},x=(0,e.useCallback)(({target:{name:P,value:N}})=>{m({type:"ON_CHANGE_SIMPLE_CHECKBOX",keys:P,value:N})},[]),B=(0,e.useCallback)(({target:{name:P,value:N}})=>{m({type:"ON_CHANGE_TOGGLE_PARENT_CHECKBOX",keys:P,value:N})},[]);return e.createElement(Je,{value:{availableConditions:o.conditions,modifiedData:c,onChangeConditions:A,onChangeSimpleCheckbox:x,onChangeParentCheckbox:B,onChangeCollectionTypeLeftActionRowCheckbox:v,onChangeCollectionTypeGlobalActionCheckbox:S}},e.createElement(Y.v,{id:"tabs",label:y({id:"Settings.permissions.users.tabs.label",defaultMessage:"Tabs Permissions"})},e.createElement(Xe.m,null,Ro.map(P=>e.createElement(Xe.O,{key:P.id},y({id:P.labelId,defaultMessage:P.defaultMessage})))),e.createElement(se.n,{style:{position:"relative"}},e.createElement(se.x,null,e.createElement(V,{layout:r.collectionTypes,kind:"collectionTypes",isFormDisabled:n})),e.createElement(se.x,null,e.createElement(V,{layout:r.singleTypes,kind:"singleTypes",isFormDisabled:n})),e.createElement(se.x,null,e.createElement(Kn,{layout:r.plugins,kind:"plugins",isFormDisabled:n})),e.createElement(se.x,null,e.createElement(Kn,{layout:r.settings,kind:"settings",isFormDisabled:n})))))});Ln.defaultProps={permissions:[],layout:{conditions:[],sections:{collectionTypes:{},singleTypes:{actions:[]},settings:[],plugins:[]}}},Ln.propTypes={layout:i().object,isFormDisabled:i().bool.isRequired,permissions:i().array};const Mo=(0,e.memo)(Ln)},34341:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},67500:(ee,b,t)=>{t.d(b,{Z:()=>e});const e=()=>"todo empty role"},52351:(ee,b,t)=>{t.d(b,{Z:()=>T});var e=t(67294),h=t(45697),i=t.n(h),te=t(41580),Y=t(11047),Xe=t(47144),se=t(18374),Oe=t(75515),Ze=t(12028),Fe=t(68547),nt=t.n(Fe),H=t(97132);const L=({id:Re,name:U,description:Me,usersCount:$,icons:je,rowIndex:_})=>{const{formatMessage:F}=(0,H.useIntl)(),qe=F({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:$});return e.createElement(Xe.Tr,{"aria-rowindex":_,key:Re,...(0,Fe.onRowClick)({fn:je[1].onClick})},e.createElement(se.Td,{maxWidth:(0,Fe.pxToRem)(130)},e.createElement(Oe.Z,{ellipsis:!0,textColor:"neutral800"},U)),e.createElement(se.Td,{maxWidth:(0,Fe.pxToRem)(250)},e.createElement(Oe.Z,{ellipsis:!0,textColor:"neutral800"},Me)),e.createElement(se.Td,null,e.createElement(Oe.Z,{textColor:"neutral800"},qe)),e.createElement(se.Td,null,e.createElement(Y.k,{justifyContent:"flex-end",...Fe.stopPropagation},je.map((G,f)=>G?e.createElement(te.x,{key:G.label,paddingLeft:f===0?0:1},e.createElement(Ze.h,{onClick:G.onClick,label:G.label,noBorder:!0,icon:G.icon})):null))))};L.propTypes={id:i().number.isRequired,name:i().string.isRequired,description:i().string.isRequired,usersCount:i().number.isRequired,icons:i().array.isRequired,rowIndex:i().number.isRequired};const T=L},85302:(ee,b,t)=>{t.d(b,{Z:()=>Ve});var e=t(67294),h=t(68547),i=t(87751),te=t(63852),Y=t(96315),Xe=t(20022),se=t(4585),Oe=t(65186),Ze=t(29728),Fe=t(67838),nt=t(49066),H=t(11057),L=t(49386),T=t(63985),Re=t(47144),U=t(18374),Me=t(550),$=t(75515),je=t(185),_=t(63237),F=t(97132),qe=t(49656),G=t(52351),f=t(67500),ze=t(45697),ie=t.n(ze),Ge=t(71893),we=t(44034),ct=t(25896),_e=t(12028),Qe=t(80994),st=t(41580),it=t(11047),ot=t(7681),le=t(17772),Ye=t(70968);const pe=t.p+"6d21938306785f176538.png",ne=t.p+"617f9c948fa79e6d73bd.png",w=Ge.default.div`
  position: absolute;
  z-index: 3;
  inset: 0;
  background: ${({theme:R})=>(0,h.setHexOpacity)(R.colors.neutral800,.2)};
  padding: 0 ${({theme:R})=>R.spaces[8]};
`,oe=(0,Ge.default)(it.k)`
  position: relative;
  max-width: ${830/16}rem;
  height: ${415/16}rem;
  margin: 0 auto;
  overflow: hidden;
  margin-top: 10%;
  padding-left: ${64/16}rem;

  img:first-of-type {
    position: absolute;
    right: 0;
    top: 0;
    max-width: ${360/16}rem;
  }

  img:not(:first-of-type) {
    width: ${130/16}rem;
    margin-left: 12%;
    margin-right: ${20/16}rem;
    z-index: 0;
  }
`,K=(0,Ge.default)(ot.K)`
  align-items: flex-start;
  max-width: ${400/16}rem;
  z-index: 0;
`,X=(0,Ge.default)(st.x)`
  position: absolute;
  right: ${({theme:R})=>R.spaces[4]};
  top: ${({theme:R})=>R.spaces[4]};
`,ge=({onClose:R,isOpen:Z})=>{(0,h.useLockScroll)(Z);const{formatMessage:j}=(0,F.useIntl)();return Z?e.createElement(we.h,null,e.createElement(w,{onClick:R},e.createElement(ct.i,{onEscape:R},e.createElement(oe,{onClick:ce=>ce.stopPropagation(),"aria-labelledby":"upgrade-plan",background:"neutral0",hasRadius:!0},e.createElement("img",{src:pe,alt:"air-balloon"}),e.createElement(X,null,e.createElement(_e.h,{onClick:R,"aria-label":"Close",icon:e.createElement(Ye.default,null)})),e.createElement(K,{spacing:6},e.createElement($.Z,{fontWeight:"bold",textColor:"primary600"},j({id:"app.components.UpgradePlanModal.text-ce",defaultMessage:"COMMUNITY EDITION"})),e.createElement(ot.K,{spacing:2},e.createElement($.Z,{variant:"alpha",as:"h2",id:"upgrade-plan"},j({id:"app.components.UpgradePlanModal.limit-reached",defaultMessage:"You have reached the limit"})),e.createElement($.Z,null,j({id:"app.components.UpgradePlanModal.text-power",defaultMessage:"Unlock the full power of Strapi by upgrading your plan to the Enterprise Edition"}))),e.createElement(Qe.Q,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(le.Z,null)},j({id:"app.components.UpgradePlanModal.button",defaultMessage:"Learn more"}))),e.createElement("img",{src:ne,alt:"upgrade-arrow"}))))):null};ge.propTypes={onClose:ie().func.isRequired,isOpen:ie().bool.isRequired};const he=ge;var De=t(48474);const Be=()=>{const{roles:R,isLoading:Z}=(0,De.bF)(),j=(0,h.useQuery)(),ce=decodeURIComponent(j.get("_q")||""),ae=(0,te.ZP)(R,ce,{keys:["name","description"]});return{isLoading:Z,sortedRoles:ae}},re=()=>{const{formatMessage:R}=(0,F.useIntl)(),[Z,j]=(0,e.useState)(!1),{trackUsage:ce}=(0,h.useTracking)(),{push:ae}=(0,qe.useHistory)(),Q=(0,e.useCallback)(M=>{ae(`/settings/roles/${M}`)},[ae]),Ce=(0,e.useCallback)(()=>{j(M=>!M)},[]),$e=(0,e.useCallback)(()=>{ce("didShowRBACUpgradeModal"),j(!0)},[ce]),dt=(0,e.useCallback)(M=>[{onClick:Ce,label:R({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(Oe.Z,null)},{onClick:()=>Q(M.id),label:R({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(se.Z,null)},{onClick:Ce,label:R({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Xe.default,null)}],[R,Ce,Q]);return{isModalOpen:Z,handleToggleModalForCreatingRole:$e,handleToggle:Ce,getIcons:dt}},Ke=()=>{const{formatMessage:R}=(0,F.useIntl)();(0,h.useFocusWhenNavigate)();const{sortedRoles:Z,isLoading:j}=Be(),{isModalOpen:ce,handleToggle:ae,handleToggleModalForCreatingRole:Q,getIcons:Ce}=re(),$e=Z.length+1,dt=5;return e.createElement(je.o,null,e.createElement(h.SettingsPageTitle,{name:"Roles"}),e.createElement(Fe.T,{primaryAction:e.createElement(Ze.z,{onClick:Q,startIcon:e.createElement(Y.default,null),size:"S"},R({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})),title:R({id:"global.roles",defaultMessage:"roles"}),subtitle:R({id:"Settings.roles.list.description",defaultMessage:"List of roles"})}),e.createElement(nt.D,null,e.createElement(H.i,{colCount:dt,rowCount:$e,footer:e.createElement(L.c,{onClick:Q,icon:e.createElement(Y.default,null)},R({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"}))},e.createElement(T.h,null,e.createElement(Re.Tr,null,e.createElement(U.Th,null,e.createElement($.Z,{variant:"sigma",textColor:"neutral600"},R({id:"global.name",defaultMessage:"Name"}))),e.createElement(U.Th,null,e.createElement($.Z,{variant:"sigma",textColor:"neutral600"},R({id:"global.description",defaultMessage:"Description"}))),e.createElement(U.Th,null,e.createElement($.Z,{variant:"sigma",textColor:"neutral600"},R({id:"global.users",defaultMessage:"Users"}))),e.createElement(U.Th,null,e.createElement(_.T,null,R({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(Me.p,null,Z?.map((M,be)=>e.createElement(G.Z,{key:M.id,id:M.id,name:M.name,description:M.description,usersCount:M.usersCount,icons:Ce(M),rowIndex:be+2})))),!$e&&!j&&e.createElement(f.Z,null)),e.createElement(he,{isOpen:ce,onClose:ae}))},Ve=()=>e.createElement(h.CheckPagePermissions,{permissions:i.Z.settings.roles.main},e.createElement(Ke,null))},35301:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=[]},26789:(ee,b,t)=>{t.d(b,{Z:()=>ot});var e=t(67294),h=t(47292),i=t(68547),te=t(41580),Y=t(29728),Xe=t(67838),se=t(49066),Oe=t(11276),Ze=t(74571),Fe=t(185),nt=t(11047),H=t(7681),L=t(75515),T=t(16364),Re=t(64256),U=t(67109),Me=t(80831),$=t(27361),je=t.n($),_=t(41609),F=t.n(_),qe=t(97132),G=t(49656),f=t(71893),ze=t(28834),ie=t(48474),Ge=t(87751),we=t(53209);const _e=we.Ry().shape({name:we.Z_().required(i.translatedErrors.required),description:we.Z_().required(i.translatedErrors.required)});var Qe=t(25108);const st=f.default.div`
  border: 1px solid ${({theme:le})=>le.colors.primary200};
  background: ${({theme:le})=>le.colors.primary100};
  padding: ${({theme:le})=>`${le.spaces[2]} ${le.spaces[4]}`};
  color: ${({theme:le})=>le.colors.primary600};
  border-radius: ${({theme:le})=>le.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,it=()=>{const le=(0,i.useNotification)(),{lockApp:Ye,unlockApp:pe}=(0,i.useOverlayBlocker)(),{formatMessage:ne}=(0,qe.useIntl)(),[w,oe]=(0,e.useState)(!1),{replace:K}=(0,G.useHistory)(),X=(0,e.useRef)(),{trackUsage:ge}=(0,i.useTracking)(),he=(0,G.useRouteMatch)("/settings/roles/duplicate/:id"),De=je()(he,"params.id",null),{isLoading:Be,data:re}=(0,ie.U_)(),{permissions:Ue,isLoading:Ke}=(0,ie.Dq)(De),E=R=>{Ye(),oe(!0),ge(De?"willDuplicateRole":"willCreateNewRole"),Promise.resolve((0,i.request)("/admin/roles",{method:"POST",body:R})).then(async Z=>{const{permissionsToSend:j}=X.current.getPermissions();return ge(De?"didDuplicateRole":"didCreateNewRole"),Z.data.id&&!F()(j)&&await(0,i.request)(`/admin/roles/${Z.data.id}/permissions`,{method:"PUT",body:{permissions:j}}),Z}).then(Z=>{oe(!1),le({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),K(`/settings/roles/${Z.data.id}`)}).catch(Z=>{Qe.error(Z),oe(!1),le({type:"warning",message:{id:"notification.error"}})}).finally(()=>{pe()})},Ve=`${ne({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,h.format)(new Date,"PPP")}`;return e.createElement(Fe.o,null,e.createElement(i.SettingsPageTitle,{name:"Roles"}),e.createElement(Me.Formik,{initialValues:{name:"",description:Ve},onSubmit:E,validationSchema:_e,validateOnChange:!1},({handleSubmit:R,values:Z,errors:j,handleReset:ce,handleChange:ae})=>e.createElement(i.Form,{noValidate:!0},e.createElement(e.Fragment,null,e.createElement(Xe.T,{primaryAction:e.createElement(H.K,{horizontal:!0,spacing:2},e.createElement(Y.z,{variant:"secondary",onClick:()=>{ce(),X.current.resetForm()},size:"L"},ne({id:"app.components.Button.reset",defaultMessage:"Reset"})),e.createElement(Y.z,{onClick:R,loading:w,size:"L"},ne({id:"global.save",defaultMessage:"Save"}))),title:ne({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:ne({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:e.createElement(i.Link,{startIcon:e.createElement(U.Z,null),to:"/settings/roles"},ne({id:"global.back",defaultMessage:"Back"}))}),e.createElement(se.D,null,e.createElement(H.K,{spacing:6},e.createElement(te.x,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(H.K,{spacing:4},e.createElement(nt.k,{justifyContent:"space-between"},e.createElement(te.x,null,e.createElement(te.x,null,e.createElement(L.Z,{fontWeight:"bold"},ne({id:"global.details",defaultMessage:"Details"}))),e.createElement(te.x,null,e.createElement(L.Z,{variant:"pi",textColor:"neutral600"},ne({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})))),e.createElement(st,null,ne({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0}))),e.createElement(Oe.r,{gap:4},e.createElement(Ze.P,{col:6},e.createElement(T.o,{name:"name",error:j.name&&ne({id:j.name}),label:ne({id:"global.name",defaultMessage:"Name"}),onChange:ae,value:Z.name})),e.createElement(Ze.P,{col:6},e.createElement(Re.g,{label:ne({id:"global.description",defaultMessage:"Description"}),name:"description",error:j.description&&ne({id:j.description}),onChange:ae},Z.description))))),!Be&&!Ke?e.createElement(te.x,{shadow:"filterShadow",hasRadius:!0},e.createElement(ze.Z,{isFormDisabled:!1,ref:X,permissions:Ue,layout:re})):e.createElement(te.x,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(i.LoadingIndicatorPage,null))))))))};function ot(){return e.createElement(i.CheckPagePermissions,{permissions:Ge.Z.settings.roles.create},e.createElement(it,null))}},53273:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},20591:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},74512:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},76766:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},85822:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},8629:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},64527:(ee,b,t)=>{t.d(b,{Z:()=>ne});var e=t(67294),h=t(68547),i=t(87751),te=t(96315),Y=t(20022),Xe=t(65186),se=t(4585),Oe=t(29728),Ze=t(67838),Fe=t(36989),nt=t(49066),H=t(63237),L=t(185),T=t(11057),Re=t(49386),U=t(63985),Me=t(47144),$=t(18374),je=t(550),_=t(75515),F=t(96486),qe=t(63852),G=t(97132),f=t(49656),ze=t(23998),ie=t(48474),Ge=t(67500),we=t(52351),ct=t(60612);const _e={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},st=(w,oe)=>(0,ct.default)(w,K=>{switch(oe.type){case"ON_REMOVE_ROLES":{K.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{K.shouldRefetchData=!0,K.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{K.shouldRefetchData=!1,K.roleToDelete=null,K.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{K.roleToDelete=oe.id;break}default:return K}}),it=()=>{(0,h.useFocusWhenNavigate)();const{isLoading:w,allowedActions:{canCreate:oe,canDelete:K,canRead:X,canUpdate:ge}}=(0,h.useRBAC)(i.Z.settings.roles),{getData:he,roles:De,isLoading:Be}=(0,ie.bF)(!1),[{query:re}]=(0,h.useQueryParams)(),Ue=re?._q||"",Ke=(0,qe.ZP)(De,Ue,{keys:["name","description"]});return(0,e.useEffect)(()=>{!w&&X&&he()},[w,X,he]),{isLoadingForPermissions:w,canCreate:oe,canDelete:K,canRead:X,canUpdate:ge,isLoading:Be,getData:he,sortedRoles:Ke,roles:De}},ot=({getData:w,canCreate:oe,canDelete:K,canUpdate:X})=>{const{formatMessage:ge}=(0,G.useIntl)(),he=(0,h.useNotification)(),[De,Be]=(0,e.useState)(!1),{push:re}=(0,f.useHistory)(),[{selectedRoles:Ue,showModalConfirmButtonLoading:Ke,roleToDelete:E},Ve]=(0,e.useReducer)(st,_e),R=async()=>{try{Ve({type:"ON_REMOVE_ROLES"}),await ze.be.post("/admin/roles/batch-delete",{ids:[E]}),await w(),Ve({type:"RESET_DATA_TO_DELETE"})}catch(M){const be=(0,F.get)(M,["response","payload","data","ids"],null);if(be&&Array.isArray(be)){const ut=be.join(`
`);he({type:"warning",message:ut})}else he({type:"warning",message:{id:"notification.error"}})}ae()},Z=(0,e.useCallback)(M=>{re(`/settings/roles/duplicate/${M}`)},[re]),j=()=>re("/settings/roles/new"),ce=(0,e.useCallback)(M=>{Ve({type:"SET_ROLE_TO_DELETE",id:M}),ae()},[]),ae=()=>Be(M=>!M),Q=(0,e.useCallback)(M=>{re(`/settings/roles/${M}`)},[re]),Ce=(0,e.useCallback)((M,be)=>{M.preventDefault(),M.stopPropagation(),be.usersCount?he({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):ce(be.id)},[he,ce]),$e=(0,e.useCallback)((M,be)=>{M.preventDefault(),M.stopPropagation(),Z(be.id)},[Z]),dt=(0,e.useCallback)(M=>[...oe?[{onClick:be=>$e(be,M),label:ge({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(Xe.Z,null)}]:[],...X?[{onClick:()=>Q(M.id),label:ge({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(se.Z,null)}]:[],...K?[{onClick:be=>Ce(be,M),label:ge({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Y.default,null)}]:[]],[ge,Ce,$e,Q,oe,X,K]);return{handleNewRoleClick:j,getIcons:dt,selectedRoles:Ue,isWarningDeleteAllOpened:De,showModalConfirmButtonLoading:Ke,handleToggleModal:ae,handleDeleteData:R}},Ye=()=>{const{formatMessage:w}=(0,G.useIntl)(),{isLoadingForPermissions:oe,canCreate:K,canRead:X,canDelete:ge,canUpdate:he,isLoading:De,getData:Be,sortedRoles:re}=it(),{handleNewRoleClick:Ue,getIcons:Ke,isWarningDeleteAllOpened:E,showModalConfirmButtonLoading:Ve,handleToggleModal:R,handleDeleteData:Z}=ot({getData:Be,canCreate:K,canDelete:ge,canUpdate:he}),j=re.length+1,ce=6;if(oe)return e.createElement(L.o,null,e.createElement(h.LoadingIndicatorPage,null));const ae=w({id:"global.roles",defaultMessage:"roles"});return e.createElement(L.o,null,e.createElement(h.SettingsPageTitle,{name:"Roles"}),e.createElement(Ze.T,{primaryAction:K?e.createElement(Oe.z,{onClick:Ue,startIcon:e.createElement(te.default,null),size:"S"},w({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:ae,subtitle:w({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),X&&e.createElement(Fe.Z,{startActions:e.createElement(h.SearchURLQuery,{label:w({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:ae})})}),X&&e.createElement(nt.D,null,e.createElement(T.i,{colCount:ce,rowCount:j,footer:K?e.createElement(Re.c,{onClick:Ue,icon:e.createElement(te.default,null)},w({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(U.h,null,e.createElement(Me.Tr,{"aria-rowindex":1},e.createElement($.Th,null,e.createElement(_.Z,{variant:"sigma",textColor:"neutral600"},w({id:"global.name",defaultMessage:"Name"}))),e.createElement($.Th,null,e.createElement(_.Z,{variant:"sigma",textColor:"neutral600"},w({id:"global.description",defaultMessage:"Description"}))),e.createElement($.Th,null,e.createElement(_.Z,{variant:"sigma",textColor:"neutral600"},w({id:"global.users",defaultMessage:"Users"}))),e.createElement($.Th,null,e.createElement(H.T,null,w({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(je.p,null,re?.map((Q,Ce)=>e.createElement(we.Z,{key:Q.id,id:Q.id,name:Q.name,description:Q.description,usersCount:Q.usersCount,icons:Ke(Q),rowIndex:Ce+2})))),!j&&!De&&e.createElement(Ge.Z,null)),e.createElement(h.ConfirmDialog,{isOpen:E,onConfirm:Z,isConfirmButtonLoading:Ve,onToggleDialog:R}))},ne=()=>e.createElement(h.CheckPagePermissions,{permissions:i.Z.settings.roles.main},e.createElement(Ye,null))},5420:(ee,b,t)=>{t.d(b,{Z:()=>h});const e=[];strapi.features.isEnabled(strapi.features.SSO)&&e.push({async Component(){return await t.e(302).then(t.bind(t,40316))},to:"/settings/single-sign-on",exact:!0}),strapi.features.isEnabled(strapi.features.AUDIT_LOGS)&&e.push({async Component(){return await Promise.all([t.e(4432),t.e(2812)]).then(t.bind(t,25857))},to:"/settings/audit-logs",exact:!0});const h=e}}]);
